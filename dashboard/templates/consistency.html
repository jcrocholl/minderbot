{% extends "base.html" %}

{% block title %}Consistency check{% endblock %}

{% block content %}
<h1>Consistency check</h1>

{% if missing_tag_list %}
<h2>Missing tags</h2>
<ul>
{% for tag, suggestion in missing_tag_list %}
<li>Tag {{ tag }} is referenced by
<a href="{{ suggestion.get_absolute_url }}">{{ suggestion }}</a>.</li>
{% endfor %}
</ul>
<form action="" method="post">
<p><input type="submit" name="create_missing_tags" value="Create missing tags" /></p>
</form>
{% endif %}

{% if missing_suggestion_list %}
<h2>Missing suggestions</h2>
<ul>
{% for suggestion, tag in missing_suggestion_list %}
<li>Suggestion {{ suggestion }} is referenced by
<a href="{{ tag.get_absolute_url }}">{{ tag }}</a>.</li>
{% endfor %}
</ul>
<form action="" method="post">
<p><input type="submit" name="delete_dangling_references" value="Delete dangling references" /></p>
</form>
{% endif %}

{% if incorrect_count_list %}
<h2>Incorrect usage count</h2>
<ul>
{% for tag in incorrect_count_list %}
<li>Tag <a href="{{ tag.get_absolute_url }}">{{ tag }}</a> has {{ tag.suggestions|length }} suggestions, but count is {{ tag.count }}.</li>
{% endfor %}
</ul>
<form action="" method="post">
<p><input type="submit" name="adjust_tag_counts" value="Adjust incorrect counts" /></p>
</form>
{% endif %}
{% endblock %}
